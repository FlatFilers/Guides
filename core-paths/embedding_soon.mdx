---
title: "Embed in your app"
description: "Learn how to securely and easily build an embedded Flatfile import experience into your client-side application"
icon: "person-to-portal"
---

## [@flatfile/react](https://www.npmjs.com/package/@flatfile/react)

Embed React is a front-end SDK wrapper around the [Flatfile API](https://reference.flatfile.com/docs/api/). It allows you to securely and easily add an embedded data import experience, also known as a [Space](/concepts/spaces), to any React app.
Using an iframe, Embed React seamlessly integrates into your website or application, providing a simple yet robust experience for collecting and transforming data from your customers.

## Before you begin

The minimum supported version of React is v16. If you use an older version, upgrade React to use this library. You will also need Node.js v18 installed on your machine.

Check your versions in terminal:

<CodeGroup>

```npm npm
node --version
npm view react version
```

```yarn yarn
yarn list --version react
```

</CodeGroup>

### Setup

Install Embed React from the npm public registry.

<CodeGroup>

```npm npm
npm install @flatfile/react@6.0
```

```yarn yarn
yarn install @flatfile/react@6.0
```

</CodeGroup>

### Get your Environment ID and Publishable Key

<Info>
  API keys are created automatically. Use the [Developers
  Page](https://platform.flatfile.com/developers) to reveal your API keys for
  each Environment.
</Info>

Copy your **publishable key** and **environment id** from the dashboard under [Developers Page](https://platform.flatfile.com/developers).

Your environment id and publishable key will look like this:

```
us_env_abc123 // environmentId
pk_xyz789 // publishableKey
```

The publishable key is safe to be used in client-side applications as it has limited access to the Flatfile API. For more on authentication, see [Authentication](../developer-tools/security/authentication).

<Warning>Do not use your secret key to embed Flatfile.</Warning>

## Getting started

When you embed Flatfile, you are using an iframe to embed a [Space](/concepts/spaces) directly into your application.

A Space consists of:

1. A [Workbook](../concepts/workbooks), which defines the structure of the data you are working with. It is analogous to a database.
2. [Events](../concepts/Events), which allow you to listen for and respond to things that occur inside your Space. Examples include uploading a file or submitting data.

In order to embed Flatfile, we need to first create a Workbook to configure our space, and create an event listener to handle events. Then we use a component that takes the configuration and listener and embeds the Space into your React app.

### Workbook configuration

Create a Workbook to configure your Space. Read more about Workbooks [here](/concepts/workbooks).

```ts config.ts
import { Flatfile, FlatfileClient } from '@flatfile/api'

export const config: Pick<
  Flatfile.WorkbookConfig,
  'name' | 'sheets' | 'actions'
> = {
  name: 'Employees workbook',
  sheets: [
    {
      name: 'Contacts',
      slug: 'Contacts',
      fields: [
        {
          key: 'first_name',
          type: 'string',
          label: 'First name',
          constraints: [
            {
              type: 'required'
            }
          ]
        },
        {
          key: 'last_name',
          type: 'string',
          label: 'last name',
          constraints: [
            {
              type: 'unique'
            }
          ]
        },
        {
          key: 'full_name',
          type: 'string',
          label: 'full name'
        }
      ]
    }
  ],
  actions: [
    {
      label: 'Submit',
      operation: 'contacts:submit',
      description: 'Would you like to submit your workbook?',
      mode: 'foreground',
      primary: true,
      confirm: true
    }
  ]
}
```

### Event listener

Here is where you define how to respond to events. In this case, since we have a "Submit" action defined in our Workbook, we use the event listener to define how we want to submit records:

```ts listener.ts
/**
 * Handle submit action
 * TODO fix this
 */
 async function startCustomJob(jobId: string) {
  console.log('starting custom job at' + new Date())

  const storedToken = sessionStorage.getItem('token')

  if (!storedToken) {
    throw new Error('Error retrieving stored token')
  }

  const Flatfile = new FlatfileClient({
    token: storedToken,
    environment: 'https://platform.flatfile.com/api/v1'
  })

  await Flatfile.jobs.ack(jobId, {
    info: "I'm starting the job - inside client",
    // progress only makes sense if multipart job - optional
    progress: 33
  })

  // convert records here (event.api.updateRecords)
  // add example vs. setTimeout
  await new Promise((res) => setTimeout(res, 2000))

  await Flatfile.jobs.complete(jobId, {
    info: "Job's work is done"
  })
}

/**
 * Example Client
 */
export const localClient = Client.create((client) => {
  client.on(
    'job:ready',
    // @ts-ignore
    { payload: { operation: 'contacts:submit' } },
    async (event: any) => {
      const { context } = event
      return startCustomJob(context.jobId)
    }
  )
})
```

### Putting it together

Now that we have our configuration defined in our Workbook, and our event handlers defined in our listener, we are ready to embed our Space.

Use the `useSpace` hook to create a Space component and pass it the configuration and listener as options:

<CodeGroup>
```ts app.ts
import { useSpace, ISpace, makeTheme } from '@flatfile/react'
import { config, localClient } from './config.ts'

const ExampleApp = () => {

const [showSpace, setShowSpace] = useState(false)

const { component } = useSpace({
  {
    name: 'Embedded Space',
    publishableKey: 'your_publishable_key',
    environmentId: 'your_environment_id',
    workbook: config,
    client: localClient
  },
  closeSpace: {
    operation: 'contacts:submit',
    onClose: () => setShowSpace(false)
  }
})

return (
  <div style={{ padding: "16px" }}>
    <button
      onClick={() => {
        setShowSpace(!showSpace);
      }}
    >
      {showSpace === true ? "Close" : "Open"} space
    </button>
    {showSpace && component}
  </div>
  )
}
```

```ts config.ts
// Paste config code here when finalized
```

```ts listener.ts
// Paste listener code here when finalized
```
</CodeGroup>

`useSpace` takes the following options:

| Name             | Description                                                               | Type                    | Required |
| ---------------- | ------------------------------------------------------------------------- | ----------------------- | -------- |
| `publishableKey` | Publishable key accessed via Flatfile dashboard > Developer               | string                  | Yes      |
| `environmentId`  | Environment ID accessed via Flatfile dashboard > Developer                                               | string                  | Yes      |
| `name`           | Name of the Space                                                             | string                  | No       |
| `workbook`       | Shape of data you will be receiving                                       | Flatfile.WorkbookConfig | Yes      |
| `client`         | Event listener for responding to events                                | Client                  | No       |
| `spaceInfo`      | Additional metadata to be passed to the space                              | tbd | No       |
| `closeSpace`     | Options for when to close the iframe and a callback function when session is complete | tbd | No       |
| `iframeStyles`   | Styles the iframe using CSS Properties                                     | React.CSSProperties     | No       |
| `themeConfig`    | Theme determining the look and feel of the Space                            | IThemeConfig            | No       |
| `sidebarConfig`  | Options for show or hide various UI elements                               | ISidebarConfig          | No       |
| `document`       | Document to pass to space                                                 | Flatfile.DocumentConfig | No       |
| `error`          | Error element to display if component throws an error                              | (error: Error \| string) => React.ReactElement | No       |
| `loading`        | Loading element to display while space loads                              | React.ReactElement      | No       |

## Advanced options

### Loading state

We provide a default loading state when the Space is loading. You can also pass a custom loading component using the `loading` prop.

### Error handling

By default, the Space component an error component with the error message when an error is encountered, providing your users with feedback on what went wrong.

If you would like to use your own error handling component instead of the default one, simply pass it in as the `error` prop when rendering the component.

### Closing behavior

```typescript

const closeSpace = {
  operation: 'contacts:submit',
  onClose: () => {}
}
```

This `onClose` callback function is called when the action defined in `operation` is complete and closes the iframe. It can also be used to perform cleanup actions, such as resetting the state of the parent application or updating the UI.

### Theming

You can theme your Space to create a custom look and feel to match your brand. There are two ways to define your theme, depending on how much control you want.

#### makeTheme

The `makeTheme` helper function generates a theme based on a primary color, text color, and logo. Different shades of the provided colors are generated and applied programmatically to create a cohesive visual style.

For more fine-grained control of individual shades, use manual CSS overrides.

```typescript
const theme = makeTheme({
  primaryColor: "red",
  textColor: "white",
  logo: "https://images.ctfassets.net/hjneo4qi4goj/gL6Blz3kTPdZXWknuIDVx/7bb7c73d93b111ed542d2ed426b42fd5/flatfile.svg",
});

const { component } = useSpace({
  themeConfig: theme,
  publishableKey,
  environmentId,
  workbook,
});
```

`makeTheme` options

| Prop           | Type     | Description         | Required |
| -------------- | -------- | ------------------- | -------- |
| `primaryColor` | `string` | Primary brand color | no       |
| `textColor`    | `string` | Text color          | no       |
| `logo`         | `string` | full url to logo    | no       |

<Tip>
  `makeTheme` accepts valid color values in the following formats: name, rgb, hsv, hex.
</Tip>

#### Manual CSS overrides

If you prefer to set colors manually using the actual CSS variables referenced in the app, you can construct the theme yourself using our [Theming Reference](../guides/theming).

```typescript
const theme = {
  // see theming reference
};

const { component } = useSpace({
  themeConfig: theme,
  publishableKey,
  environmentId,
  workbook,
});
```

### Styling the iframe

Use the `iframeStyles` prop to style the outer iframe that the space is wrapped in. `iframeStyle` accepts a JavaScript object with camel-cased properties rather than a CSS string.

```typescript
const iframeStyles = {
  width: '100%',
  height: '750px',
  borderWidth: 0,
  borderRadius: '20px',
  background: '#fff',
  padding: '16px'
}

const { component } = useSpace({
  themeConfig: theme,
  publishableKey,
  environmentId,
  workbook,
  iframeStyles
});
```

### Collecting additional data

The Space component offers the flexibility to pass in additional metadata through the use of `spaceInfo` prop. This prop allows you to provide information such as user ID, space name, company ID, and company name to the component, which is used to make the dashboard search / filter experience more effective.

To use the `spaceInfo` prop, simply create an object that implements the `ISpaceInfo` interface and pass it in as `spaceInfo` prop when rendering the component.

```typescript
export interface ISpaceInfo {
  userId?: string
  name?: string
  companyId?: string
  companyName?: string
}
```

For example, if you wanted to provide the component with a user ID and space name, you could create an object like this:

```typescript
const spaceInfo: ISpaceInfo = {
  userId: "1234",
  name: "My Space",
}
```

### Guest Sidebar

You can customize your guest sidebar using the [Sidebar Reference](../guides/guest_sidebar) or you can hide it completely (most common). Pass your sidebar configuration to your `useSpace` hook or `Space` component.

<CodeGroup>
```typescript sidebarConfig
const mySidebarConfig = {
  showDataChecklist: false,
  defaultPage: {
    workbook: {
      workbookId: "123",
      sheetId: "123",
    },
  },
};
```

```typescript Example passed to useSpace hook
const { component } = useSpace({
  sidebarConfig: mySidebarConfig,
  publishableKey,
  environmentId,
  workbook,
});
```

</CodeGroup>

| Property                | Type                                                                           | Description                                                                                         |
| ----------------------- | ------------------------------------------------------------------------------ | --------------------------------------------------------------------------------------------------- |
| `defaultPage`           | `{ documentId?: string, workbook?: { workbookId: string, sheetId?: string } }` | Landing page upon loading a space. Defaults to primary workbook.  |
| `showGuestInvite`       | `boolean`                                                                      | Toggle ability to invite guests. Defaults to false.                                                 |
| `showDataChecklist`     | `boolean`                                                                      | Toggle data config for space. Defaults to false.                                                    |
| `showSidebar`           | `boolean`                                                                      | Toggle whether sidebar defaults to open inside of a Workbook. Defaults to false.                    |

### Documents

<Tooltip tip="Standalone webpages...">[Documents]('../guides/documents)</Tooltip>, written in Markdown, provide extra clarification and instructions to users of a Space. Each Document will appear in the sidebar of a Space. Standard syntax is supported.

<CodeGroup>

```typescript documentConfig
const mainDocument = {
  title: "Getting Started",
  body:
    "![Shop](https://coconut.show/logo-big.png)\n" +
    "\\\n" +
    "&nbsp;\n" +
    "\n" +
    "---\n" +
    "\n" +
    "# Welcome to the Surf Shop!\n" +
    "\n" +
    "Please upload your contacts to the Surf Shop using the Files menu on the left.\n",
};
```

```typescript Example passed to useSpace hook
const { component } = useSpace({
  publishableKey,
  sidebarConfig: mySidebarConfig,
  environmentId,
  document: mainDocument,
  workbook,
});
```
</CodeGroup>



## Full code examples

### Joining Fields

<CodeGroup>

```typescript useSpace hook
console.log("Hello World");
```

```typescript client
print("Hello World!");
```

```typescript workbook
class HelloWorld {
public static void main(String[] args) {
System.out.println("Hello, World!");
}
}
```

</CodeGroup>

[Try it live](www.examplelink.com)

### Splitting Fields

<CodeGroup>

```typescript useSpace hook
console.log("Hello World");
```

```typescript client
print("Hello World!");
```

```typescript workbook
class HelloWorld {
public static void main(String[] args) {
System.out.println("Hello, World!");
}
}
```

</CodeGroup>

[Try it live](www.examplelink.com)

### Cross field validation

<CodeGroup>

```typescript useSpace hook
console.log("Hello World");
```

```typescript client
print("Hello World!");
```

```typescript workbook
class HelloWorld {
public static void main(String[] args) {
System.out.println("Hello, World!");
}
}
```

</CodeGroup>

[Try it live](www.examplelink.com)

### Using an npm package

<Info>
  Not all npm packages work in the browser. If you are having an issue using an
  npm package, it may be because it is only intended for server-side use.
</Info>

<CodeGroup>

```typescript useSpace hook
console.log("Hello World");
```

```typescript client
print("Hello World!");
```

```typescript workbook
class HelloWorld {
public static void main(String[] args) {
System.out.println("Hello, World!");
}
}
```

</CodeGroup>

[Try it live](www.examplelink.com)

### Validating against an external API

<CodeGroup>

```typescript useSpace hook
console.log("Hello World");
```

```typescript client
print("Hello World!");
```

```typescript workbook
class HelloWorld {
public static void main(String[] args) {
System.out.println("Hello, World!");
}
}
```

</CodeGroup>

[Try it live](www.examplelink.com)

## Example product use cases

The following are a handful of examples of ways you can validate and transform data using Flatfile.

1. **E-commerce platform:** An e-commerce platform might embed Flatfile to allow their customers to manipulate their product data before importing it into the platform. Their customers can use the tool to make sure every item has a unique SKU, transform all dollar amounts to the same format, and make sure no item has a negative number in inventory.

2. **Marketing automation software:** A marketing automation software might embed Flatfile to allow their customers to validate all email addresses before importing it into the software. Additionally, they can make sure they have a first name for every contact, decide to remove all contacts who don't have a phone number that can recieve text messages, and track opt-ins.

3. **Business intelligence software:** A business intelligence software might embed Flatfile to allow customers to clean up their data before visualizing it in the software. Customers could use the tool to split address to multiple fields from one full address field, make sure no date is before the year 1900, and calculate a unique ID from 3 other identifying fields.

4. **Healthcare software:** A healthcare software might embed Flatfile to allow their hospitals to manipulate patient data before importing it into the software. Customers can use the tool to make sure each patient has a social security number, highlight patients with dependents, and validate a patient has the right codes applied to them.

To find the additional Flatfile integration paths that may work better for your business, explore our other core paths:

<CardGroup cols={2}>
  <Card title="Setup headless file feeds" icon="bolt-auto" href="headless">
    Automatically collect data files from any source.
  </Card>
  <Card title="Run onboarding projects" icon="arrow-progress" href="collaborate">
    Collaborate across teams on large data onboarding projects.
  </Card>
</CardGroup>
````
