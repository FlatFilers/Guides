---
title: "Javascript"
description: "Securely and easily build an embedded Flatfile import experience into your javascript application"
icon: "js"
---

<Snippet file="shared/embed_concepts.mdx" />

## Before you begin

### Install the package

Install Embed Javascript from the npm/yarn public registry.

<CodeGroup>

```npm npm
npm install @flatfile/javascript@latest
```

```yarn yarn
yarn add @flatfile/javascript@latest
```

</CodeGroup>

## Embed a Space

### Before you begin

<Snippet file="shared/pk_needed.mdx" />

#### Check for proper guestAuthentication

The Space you'll create must have `guestAuthentication` configured with `shared_link` as an
option. This is inherited from the Environment you're working in. This comes standard on any out of the box Environments so you shouldn't have to do anything unless you made a new Environment. If so, update your environment if `shared_link` isn't there.

### Part 1: Review your package.json

Make sure you have the `@flatfile/javascript` packages at minimum in your package.json. You can also copy this exactly and use a Parcel bundler as a starting point if you want to start from a fresh repo.

```json package.json
{
  "name": "",
  "version": "",
  "description": "",
  "scripts": {
    "start": "parcel public/index.html"
  },
  "keywords": [],
  "author": "",
  "license": "ISC",
  "dependencies": {
    "@flatfile/javascript": "0.1.1"
  },
  "devDependencies": {
    "@parcel/resolver-default": "^2.9.3",
    "buffer": "^5.7.1",
    "crypto-browserify": "^3.12.0",
    "events": "^3.3.0",
    "os-browserify": "^0.3.0",
    "path-browserify": "^1.0.1",
    "process": "^0.11.10",
    "stream-browserify": "^3.0.0",
    "url": "^0.11.1"
  }
}
```

### Part 2: Add a Flatfile button and start your client

1. Add a button to your application to open Flatfile in a modal. Pass in your `publishableKey` and a new Space will be created on each page load.
2. Next, start your front end by heading to terminal and `npm run start`
3. To see that it’s running, visit: https://localhost:1234 and you should see your page and a button.

<CodeGroup>
```html public/index.html (snippet)
<button onclick="openFlatfile('pk_1234')">
    Create new Space
</button>
```
```html public/index.html (full page)
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Hello, world!</title>
    <script type="module" src="../src/client.js"></script>
    <link rel="stylesheet" type="text/css" href="./styles.css" />
  </head>
  <body>
    <div class="container">
      <div class="content">
        <h2><code>&lt;Flatfile /&gt;</code></h2>
        <p>Embed Flatfile in just a few lines of code.</p>

        <!-- Button to trigger the modal -->
        <div>
          <button
            class="contrast"
            onclick="openFlatfile('pk_1234')"
          >
            Create new Space
          </button>
        </div>
      </div>
    </div>

  </body>
</html>
```
</CodeGroup>

### Part 2: initializeFlatfile()

Import `@flatfile/javascript` to initialize Flatfile. Pass it any [options](../overview#shared-properties).

<Note>Note: Only `publishableKey` is required.</Note>

```js src/client.js
import { initializeFlatfile } from "@flatfile/javascript";

//create a new space in modal
window.openFlatfile = (publishableKey) => {
  const flatfileOptions = {
    publishableKey,
    // Additional props...
  };

  initializeFlatfile(flatfileOptions);
};
```

### Part 3: Override Styles

The css here is for styling how you want things to look outside of the Flatfile iframe, like the exit dialog and the dialog wrapper. Theming the Flatfile application is done in your listener [here](../../../../guides/theming).

```css public/style.css
/* Styles for home page */
html,
body {
  height: 100%;
  margin: 0;
  padding: 0;
  font-family: sans-serif;
  background: #090b2b;
  color: #fff;
}

.container {
  display: flex;
  align-items: center;
  justify-content: center;
  height: 100%;
}

.content {
  /* Adjust the width and height as needed */
  width: 800px;
  height: 200px;
  padding: 0 20px 0 50px;
}

.contrast {
  padding: 10px;
  margin: 10px 5px 0 0;
  border-radius: 4px;
  border: 0;
  font-weight: 600;
  cursor: pointer;
}

/* End of styles for home page */

/* Begin style overrides for Flatfile Dialog */

.flatfile_displayAsModal {
  padding: 50px !important;
  width: calc(100% - 100px) !important;
  height: calc(100vh - 100px) !important;
}

:root {
  --ff-primary-color: red !important;
  --ff-secondary-color: #616a7d !important;
  --ff-text-color: #090b2b !important;
  --ff-dialog-border-radius: 4px !important;
  --ff-border-radius: 5px !important;
  --ff-bg-fade: rgba(0, 0, 0, 0.2) !important;
}

/* .flatfile_iframe-wrapper {
} */

/* .flatfile_iframe-wrapper {
} */

.flatfile_iframe-wrapper.flatfile_displayAsModal {
  background: var(--ff-bg-fade);
}

/* .flatfile_displayAsModal .flatfile_close-button {
} */

.flatfile_displayAsModal .flatfile_close-button svg {
  fill: var(--ff-secondary-color);
}

/* #flatfile_iframe {
} */

.flatfile_displayAsModal #flatfile_iframe {
  border-radius: var(--ff-border-radius);
}

.flatfile_outer-shell {
  background-color: var(--ff-bg-fade);
  border-radius: var(--ff-border-radius);
}

/* .flatfile_inner-shell {
} */

.flatfile_modal {
  border-radius: var(--ff-dialog-border-radius);
}

/* .flatfile_button-group {
} */

/* .flatfile_button {
} */

.flatfile_primary {
  border: 1px solid var(--ff-primary-color);
  background-color: var(--ff-primary-color);
  color: #fff;
}

.flatfile_secondary {
  color: var(--ff-secondary-color);
}

.flatfile_modal-heading {
  color: var(--ff-text-color);
}

.flatfile_modal-text {
  color: var(--ff-secondary-color);
}
```

### Part 4: Review File Structure

When you're finished, your app should look something like this:

```
- public
  |__ index.html
  |__ style.css

- src
  |__ client.js

- package.json
```

In this file structure, your app should have two main directories, `public` and `src.`

The `public` directory contains the "index.html" file, which is the entry point of the application's front-end, and the "style.css" file for styling the iframe.

The `src` directory contains the main components and logic of the application, including the "client.js" file, which initializes Flatfile and passes in available options.

### Part 5: Start your event listener

When the “Open Flatfile” button is clicked on your platform, it triggers a job event within the Space domain that initiates a configure operation. This operation is analogous to performing a POST request to the endpoint /api/v1/spaces with the parameter autoconfigure set to true.

In this step, we'll kickstart an event listener where you'll listen for that job and configure your Space on the fly.

Follow [this guide](../../../../guides/dynamic-configurations) to dynamically configure a new Space to your liking.

<Info>
  If you don't want to do this part yet, you can also [reuse a demo
  Space](#reuse-an-existing-space) and simply pass that info in.
</Info>

## Reuse an existing Space

To reuse an existing Space, we'll update our files to pass in a Space Id instead of a `publishableKey`. We'll then make a server-side request using our `secretKey` to get the Space and its access token.

### Before you begin

<Snippet file="shared/sk_needed.mdx" />

#### Check for proper `guestAuthentication`

The Space you're using must have `guestAuthentication` configured with `shared_link` as an
option. This comes standard on any out of the box Environments (Spaces inherit from Environments) so you shouldn't have to do anything unless you made a new Environment. If so, update your Space if `shared_link` isn't there.

#### Install additional packages

<CodeGroup>

```npm npm
npm install @flatfile/api@latest dotenv express cors parcel
```

```yarn yarn
yarn add @flatfile/api@latest dotenv express cors parcel
```

</CodeGroup>

### Part 1: Update your .env

Make sure you now have your `secretKey` and `spaceId` in your .env file.

```json .env
SECRET_KEY=sk_1234
BASE_URL=https://platform.flatfile.com/api
SPACE_ID=us_sp_123
```

### Part 2: Review your package.json

Make sure you have the following packages (`dotenv express cors parcel`) and the new server script at minimum in your package.json.

```json package.json
{
  "name": "",
  "version": "",
  "description": "",
  "scripts": {
    "start": "parcel public/index.html",
    "server": "node src/server.mjs"
  },
  "keywords": [],
  "author": "",
  "license": "ISC",
  "dependencies": {
    "dotenv": "^16.3.1",
    "@flatfile/api": "1.5.15",
    "@flatfile/javascript": "0.1.1",
    "cors": "^2.8.5",
    "express": "4.18.2",
    "parcel": "2.8.3"
  },
  "devDependencies": {
    "@parcel/resolver-default": "^2.9.3",
    "buffer": "^5.7.1",
    "crypto-browserify": "^3.12.0",
    "events": "^3.3.0",
    "os-browserify": "^0.3.0",
    "path-browserify": "^1.0.1",
    "process": "^0.11.10",
    "stream-browserify": "^3.0.0",
    "url": "^0.11.1"
  }
}
```

### Part 3: Add a Flatfile button and start your client

1. Add a button to your application to open Flatfile in a modal. Note that nothing needs to be passed into the function.
2. Next, start your front end
3. To see that it's running, visit: https://localhost:1234 and you should see your button.

<CodeGroup>
```html public/index.html
<button class="contrast" onclick="openFlatfile()">Open existing Space</button>
```

```html public/index.html (full page)
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Hello, world!</title>
    <script type="module" src="../src/client.js"></script>
    <link rel="stylesheet" type="text/css" href="./styles.css" />
  </head>
  <body>
    <div class="container">
      <div class="content">
        <h2><code>&lt;Flatfile /&gt;</code></h2>
        <p>Embed Flatfile in just a few lines of code.</p>

        <!-- Button to trigger the modal -->
        <div>
          <button class="contrast" onclick="openFlatfile()">
            Open existing Space
          </button>
        </div>
      </div>
    </div>
  </body>
</html>
```

</CodeGroup>

### Part 4: initializeFlatfile()

Import `@flatfile/javascript` to initialize Flatfile. Then, retrieve information about your Flatfile space from your server. Last, pass it any [options](../overview#shared-properties).

<Note>Note: Only `space` is required.</Note>

```js src/client.js
import { initializeFlatfile } from "@flatfile/javascript";

window.openFlatfile = () => {
  fetch(server_url + "/space") // Make a request to the server endpoint
    .then((response) => response.json())
    .then((space) => {
      const flatfileOptions = {
        space: {
          id: space && space.data && space.data.id,
          accessToken: space && space.data && space.data.accessToken,
        },
        displayAsModal: false,
      };
      initializeFlatfile(flatfileOptions);
    })
    .catch((error) => {
      console.error("Error retrieving space in client:", error);
    });
};
```

### Part 5: Create and start a Server

1. Create a basic Express.js server that will retrieve your Space data from the Flatfile API.
2. Now, run the server by heading to your terminal and `npm run server`.
3. To see that it's running, visit: https://localhost:8080 and you should see "Hello, World"

```js src/server.mjs
import dotenv from "dotenv";
import express from "express";
import { FlatfileClient } from "@flatfile/api";
import cors from "cors"; // Import the cors module

dotenv.config();

const app = express();
const port = 8080;

const flatfile = new FlatfileClient({
  token: process.env.SECRET_KEY,
  environment: process.env.BASE_URL + "/v1",
});

// Enable CORS middleware
app.use(cors());

app.get("/", (req, res) => {
  res.send("Hello, world!");
});

app.get("/space", async (req, res) => {
  try {
    const space = await flatfile.spaces.get(process.env.SPACE_ID);
    res.json(space);
  } catch (error) {
    console.error("Error retrieving space:", error);
    res.status(500).json({ error: "Failed to retrieve space" });
  }
});

app.listen(port, () => {
  console.log(`Server is running on port ${port}`);
});
```

### Part 6: Review File Structure

When you're finished, your app should look something like this:

```
- public
  |__ index.html
  |__ style.css

- src
  |__ client.js
  |__ server.mjs

- package.json
```

## Example Project

Find the Javascript example project in the Flatfile GitHub repository.

<CardGroup cols={2}>
  <Card
    title="create-flatfile-javascript"
    icon="js"
    href="https://github.com/FlatFilers/create-flatfile-javascript"
  >
    Clone the Flatfile Javascript tutorial here.
  </Card>
</CardGroup>

##
