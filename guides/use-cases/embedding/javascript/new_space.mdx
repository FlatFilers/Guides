---
title: "Embed a new Space"
description: "Create a new Space every time Flatfile is opened."
icon: "plus"
---

For synchronous data import/exchange completed in one session, create a new Space each time Flatfile is opened. This suits situations where a clean slate for every interaction is preferred.

## Before you begin

<Snippet file="shared/pk_needed.mdx" />

<Snippet file="shared/guestauth.mdx" />

## Prepare your project

### Install packages

Follow prompts from the `init` command, then install packages. (We'll use `parcel` for bundling.) Once complete, run `npm install` from your terminal.

```ssh
npm init
npm i @flatfile/javascript @flatfile/listener @flatfile/plugin-record-hook
npm i parcel --save-dev
```

### Create your file structure

Setup your app to look something like this:

```
- public
  |__ index.html
  |__ styles.css

- src
  |__ client.js
  |__ workbook.js
  |__ listener.js

- package.json (already created)
- package-lock.json (already created)
```

In this file structure, your app should have two main directories, `public` and `src.`

The `public` directory contains the "index.html" file, which is the entry point of the application's front-end, and the "style.css" file for styling the iframe.

The `src` directory contains the main components and logic of the application, including the "client.js" file, which initializes Flatfile and passes in available options.

## Build your importer

### 1. Add a Flatfile button

Add a button to your application to open Flatfile in a modal. Pass in your `publishableKey` and a new Space will be created on each page load.

<CodeGroup>
```html public/index.html (snippet)
 <button
  onclick="openFlatfile({ publishableKey: 'pk_1234', environmentId: 'us_env_1234' })"
>
  Create new Space
</button>
```

```html public/index.html (full page)
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Hello, world!</title>
    <script type="module" src="../src/client.js"></script>
    <link rel="stylesheet" type="text/css" href="./styles.css" />
  </head>

  <body>
    <div class="container">
      <div class="content">
        <h2><code>&lt;Flatfile /&gt;</code></h2>
        <p>Embed Flatfile in just a few lines of code.</p>

        <!-- Button to trigger the modal -->
        <div>
          <!-- Note: PUT YOUR KEY AND ENVIRONMENT_ID IN HERE -->
          <button
            class="contrast"
            onclick="openFlatfile({ publishableKey: 'pk_1234', environmentId: 'us_env_1234' })"
          >
            Create new Space
          </button>
        </div>
      </div>
      <div id="flatfile_iFrameContainer"></div>
    </div>
  </body>
</html>
```

</CodeGroup>

### 2. Initialize Flatfile

In your `client.js`, at minimum, you'll need to receive the `publishableKey` and the `environmentId` set from when you called `openFlatfile`.

```js src/client.js
import { initializeFlatfile } from "@flatfile/javascript";
import { workbook } from "./workbook";
//import { configureFlatfileListener } from "../listeners/simple";

//create a new space in modal
window.openFlatfile = ({ publishableKey, environmentId }) => {
  if (!publishableKey && !environmentId) {
    throw new Error(
      "You must provide a publishable key and an environment ID - pass through in index.html"
    );
  }
  const flatfileOptions = {
    publishableKey,
    environmentId,
    sidebarConfig: {
      showSidebar: false,
    },
    // Additional props...
  };

  initializeFlatfile(flatfileOptions);
};
```

### 3. Start your client

Now, start your front end by heading to terminal and running the following command. To see that itâ€™s running, visit: https://localhost:1234 (or the port it is running on) and you should see your page and a button. Click the button and see that an empty Space gets created.

```ssh
npx parcel public/index.html
```

### 4. Build a Workbook

Now, let's build a Workbook inside the Space for next time.

1. Update your `workbook.js` with this simple Blueprint.
2. Update `client.js` to import the Workbook.

Next time you open Flatfile, you'll see a Workbook called "Contacts" that has one Sheet with three fields. Your Workbook will also have a Submit action. We will configure this action in the next step.

<CodeGroup>
```js src/workbook.js
export const workbook = {
  name: "All Data",
  labels: ["pinned"],
  sheets: [
    {
      name: "Contacts",
      slug: "contacts",
      fields: [
        {
          key: "firstName",
          type: "string",
          label: "First Name",
        },
        {
          key: "lastName",
          type: "string",
          label: "Last Name",
        },
        {
          key: "email",
          type: "string",
          label: "Email",
        },
      ],
    },
  ],
  actions: [
    {
      operation: "submitActionFg",
      mode: "foreground",
      label: "Submit foreground",
      description: "Submit data to webhook.site",
      primary: true,
    },
  ],
};
```

```js src/workbook.js
import { initializeFlatfile } from "@flatfile/javascript";
import { workbook } from "./workbook";
//create a new space in modal
window.openFlatfile = ({ publishableKey, environmentId }) => {
  if (!publishableKey && !environmentId) {
    throw new Error(
      "You must provide a publishable key and an environment ID - pass through in index.html"
    );
  }

  const flatfileOptions = {
    publishableKey,
    environmentId,
    workbook,
    sidebarConfig: {
      showSidebar: false,
    },
    // Additional props...
  };

  initializeFlatfile(flatfileOptions);
};
```

</CodeGroup>

### 5. Transform and Validate Data

Next, we'll listen for data changes and respond using an event listener.

1. Update your `listener.js` with this simple `recordHook`.
2. Update `client.js` to import the listener.

Once you add this code, when a change occurs, we'll log the entered first name and update the last name to "Rock." You'll immediately see this begin to work when you add or update any records. Learn more about [Handling Data](../../../guides/handling-data)

<CodeGroup>

```jsx src/listener.js
import { FlatfileListener } from "@flatfile/listener";
import { recordHook } from "@flatfile/plugin-record-hook";

export const listener = FlatfileListener.create((listener) => {
  listener.on("**", (event) => {
    console.log("Event =>", event);
  });

  listener.use(
    recordHook("contacts", (record) => {
      const firstName = record.get("firstName");
      console.log({ firstName });
      record.set("lastName", "Rock");
      return record;
    })
  );
});
```

```js src/workbook.js
import { initializeFlatfile } from "@flatfile/javascript";
import { workbook } from "./workbook";
import { listener } from "../listeners/simple";

//create a new space in modal
window.openFlatfile = ({ publishableKey, environmentId }) => {
  if (!publishableKey && !environmentId) {
    throw new Error(
      "You must provide a publishable key and an environment ID - pass through in index.html"
    );
  }

  const flatfileOptions = {
    publishableKey,
    environmentId,
    workbook,
    listener,
    sidebarConfig: {
      showSidebar: false,
    },
    // Additional props...
  };

  initializeFlatfile(flatfileOptions);
};
```

</CodeGroup>

### 6. Match your brand colors

By attaching a `themeConfig`, we will now override colors in your Space to match your brand. See all of the options here in the [Theming Reference](../../../guides/theming).

```jsx src/client.js
const flatfileOptions = {
  publishableKey,
  environmentId,
  workbook,
  listener,
  sidebarConfig: {
    showSidebar: false,
  },
  themeConfig: {
    primaryColor: "red",
    textColor: "white",
    logo: "https://images.ctfassets.net/hjneo4qi4goj/gL6Blz3kTPdZXWknuIDVx/7bb7c73d93b111ed542d2ed426b42fd5/flatfile.svg",
  },
  // Additional props...
};
```

### 7. Configure a Submit Action

Finally, let's get the data out. We'll add a new listener to egress data to your destination.

```jsx src/listener.js
import { FlatfileListener } from "@flatfile/listener";
import api, { FlatfileClient } from "@flatfile/api";
import { recordHook } from "@flatfile/plugin-record-hook";

export const listener = FlatfileListener.create((listener) => {
  listener.on("**", (event) => {
    console.log("Event =>", event);
  });

  listener.use(
    recordHook("contacts", (record) => {
      const firstName = record.get("firstName");
      console.log({ firstName });
      record.set("lastName", "Rock");
      return record;
    })
  );

  listener.filter({ job: "workbook:submitActionFg" }, (configure) => {
    configure.on("job:ready", async ({ context: { jobId } }) => {
      try {
        await flatfile.jobs.ack(jobId, {
          info: "Getting started.",
          progress: 10,
        });

        // Make changes after cells in a Sheet have been updated
        console.log("Make changes here when an action is clicked");

        await flatfile.jobs.complete(jobId, {
          outcome: {
            message: "This job is now complete.",
          },
        });
      } catch (error) {
        console.error("Error:", error.stack);

        await flatfile.jobs.fail(jobId, {
          outcome: {
            message: "This job encountered an error.",
          },
        });
      }
    });
  });
});
```

## Example Project

Find the Javascript example project in the Flatfile GitHub repository.

<CardGroup cols={1}>
  <Card
    title="create-flatfile-javascript"
    icon="js"
    href="https://github.com/FlatFilers/create-flatfile-javascript"
  >
    Clone the Flatfile Javascript tutorial here.
  </Card>
</CardGroup>
