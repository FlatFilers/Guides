---
title: "React"
description: Securely and easily build an embedded Flatfile import experience into your React application
icon: "react"
---

## Before you begin

<Snippet file="shared/account_needed.mdx" />

### Install the package

Install Embed React from the npm/yarn public registry.

<CodeGroup>

```npm npm
npm install @flatfile/react@latest
# expects "16.0.0" or greater
```

```yarn yarn
yarn add @flatfile/react@latest
# expects "16.0.0" or greater
```

</CodeGroup>

<Snippet file="shared/embed_concepts.mdx" />

## Embed a Space

### Part 1: Build a Workbook

Create a Workbook to configure your Space.

```js src/config.ts
import { Flatfile } from "@flatfile/api";

export const config: Pick<
  Flatfile.CreateWorkbookConfig,
  "name" | "sheets" | "actions"
> = {
  name: "Employees workbook",
  sheets: [
    {
      name: "Contacts",
      slug: "Contacts",
      fields: [
        {
          key: "first_name",
          type: "string",
          label: "First name",
          constraints: [
            {
              type: "required",
            },
          ],
        },
        {
          key: "last_name",
          type: "string",
          label: "last name",
          constraints: [
            {
              type: "unique",
            },
          ],
        },
        {
          key: "full_name",
          type: "string",
          label: "full name",
        },
      ],
    },
  ],
  actions: [
    {
      label: "Submit",
      operation: "contacts:submit",
      description: "Would you like to submit your workbook?",
      mode: "foreground",
      primary: true,
      confirm: true,
    },
  ],
};
```

### Part 2: Handle Events

In the event listener below, first we will use Flatfile's record hook plugin to automatically re-format, correct, validate, and enrich data during the data import process.

Since we have a defined "Submit" action in our Workbook, next we utilize the Event listener to determine the method by which we want to submit records.

<Warning>
  While a client-side listener will be able to handle a lot of the interaction
  and updates in the browser, there may be operations it can't perform due to
  these limitations. For tasks that need to access server resources or
  capabilities, a server-side listener will also be required. [Learn
  more](../../../../developer-tools/client_server_side)
</Warning>

#### Install the plugin

First, download the `recordHook` plugin from npm.

```
npm i @flatfile/plugin-record-hook
```

#### Build the listener

```js src/listener.ts
import { recordHook } from "@flatfile/plugin-record-hook";
import api from "@flatfile/api";
import { FlatfileListener } from "@flatfile/listener";

async function submit(jobId: string) {
  await api.jobs.ack(jobId, {
    info: "I'm starting the job - inside client",
    progress: 33,
  });

  // hit your api here
  await new Promise((res) => setTimeout(res, 2000));

  await api.jobs.complete(jobId, {
    info: "Job's work is done",
    outcome: { next: { type: "wait" } },
  });
}

/**
 * Example Listener
 */

export const listener = FlatfileListener.create((client) => {
  // Lowercases the first_name field
  client.use(
    recordHook("Contacts", (record) => {
      const value = record.get("first_name");
      if (typeof value === "string") {
        record.set("first_name", value.toLowerCase());
      }
      return record;
    })
  );
  // Waits for the submit button to be clicked
  client.on(
    "job:ready",
    // @ts-ignore
    { payload: { operation: "contacts:submit" } },
    async (event: any) => {
      const { context } = event;
      return submit(context.jobId);
    }
  );
});
```

### Part 3: Embed into your app

Now that we have our configuration defined in our Workbook, and our Event handlers defined in our listener, we are ready to embed our Space.

#### Create a Space component

The `useSpace` hook configures a Space component.

<Note>
  Note: the Space must have `guestAuthentication` configured with `shared_link`
  as an option. This is inherited from Environment. [Learn
  more](../../../../developer-tools/environment#guest-authentication).
</Note>

A new Space will be created each time Flatfile is initialized. To reuse a space, learn more about the [space](#space) property.

```js src/App.tsx
import { useSpace, ISpace, makeTheme } from '@flatfile/react'
import { config } from './config.ts'
import { listener } from './listener.ts'
import { useState } from 'react'

const ExampleApp = () => {

const [showSpace, setShowSpace] = useState(false)

const space = useSpace({
name: 'Embedded Space',
publishableKey: 'your_publishable_key',
environmentId: 'your_environment_id',
workbook: config,
listener: listener,
closeSpace: {
operation: 'contacts:submit',
onClose: () => setShowSpace(false)
}
})

return (

{" "}
<div style={{ padding: "16px" }}>
  <button
    onClick={() => {
      setShowSpace(!showSpace);
    }}
  >
    {showSpace === true ? "Close" : "Open"} space
  </button>
  {showSpace && space}
</div>) }
```

### Part 4: Configure the Close Dialog

When closing the Flatfile iframe, end users will see a dialog asking them if they are sure they want to exit. To style this dialog to match your application, add a `style.css` file to your public folder and link to it from `index.html`, also in the public folder.

<CodeGroup>

```css public/style.css
@font-face {
  font-family: sans-serif;
  font-weight: 700;
  font-style: normal;
}
:root {
  --brand-font-sans-serif: "Helvetica", sans-serif;
  --color-electric-800: #3b2fc9; //primary button color on hover (confirmation pop up)
  --color-electric-700: #4c48ef; //primary button color (confirmation pop up)
  --color-pigeon-600: #8b93a4; //text color (confirmation pop up)
  --color-pigeon-300: #d7dee8; // color of the border around secondary button (confirmation pop up)
  --color-pigeon-200: #e8edf4; //secondary button color (confirmation pop up)
  --color-text: var(
    --color-pigeon-primary
  ); //header text color and secondary button text color (confirmation pop up)
  --text-font: var(--brand-font-sans-serif);
  --size-base: 15px; //size of the header text (confirmation pop up)
}
body {
  background-color: #fff; //background color behind the Flatfile button
  color: var(
    --color-text
  ); //text color when text is present on the page where Flatfile button is embedded (text defined inside "index.html" file
  font-family: var(
    --text-font
  ); //font style of the text that is on the page where Flatfile button is embedded (text defined inside "index.html" file
  font-size: var(
    --size-base
  ); //font size of the text that is on the page where Flatfile button is embedded (text defined inside "index.html" file
  line-height: 1.5; //distance between the text that is defined in "index.html" file and the Flatfile button. Also distance between header text and description on confirmation pop up.
  margin: 0;
}

.flatfile-close-button {
  display: block;
}
```

```html public/index.html
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="" />

    <link rel="stylesheet" type="text/css" href="/style.css" />

    <title>Flatfile React App</title>
  </head>
  <body>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
  </body>
</html>
```

</CodeGroup>

### Part 5: Review File Structure

When you're finished, your app should look something like this:

```
- public
  |__ index.html
  |__ style.css

- src
  |__ App.tsx
  |__ config.ts
  |__ index.tsx
  |__ listener.ts

- package.json
```

In this file structure, your app should have two main directories, `public` and `src.`

The `public` directory contains the "index.html" file, which is the entry point of the application's front-end, and the "style.css" file for styling the iframe.

The `src` directory contains the main components and logic of the application, including the "App.tsx" file, which represents the root component, the "config.ts" file for creating your Workbook, the "index.tsx" file, which is the entry point of your application's code, and the "listener.ts" file, which handles your specific functionality related to listening to events.

## Example Project

Find the React example project in the Flatfile GitHub repository.

<CardGroup cols={2}>
  <Card
    title="create-flatfile-react"
    icon="react"
    href="https://github.com/FlatFilers/create-flatfile-react"
  >
    Clone the Flatfile create-react-app tutorial here.
  </Card>
</CardGroup>
````
