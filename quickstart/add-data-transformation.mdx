---
title: 2. Transform & validate data
description: "Begin the process of validating and transforming data in Flatfile by implementing a basic event handler."
---

In the previous step, you created a workbook with a simple schema. Before continuing, head over to your [Dashboard](https://platform.flatfile.com) and:
- Manually add a few sample records
- Try exporting [this CSV file](https://docs.google.com/spreadsheets/d/1hhTv_T2kRE6tmhEAZEk9TuJI_6B1Zd9r1Pw7Q3hTxuA/edit#gid=0) and uploading it into your workbook

Every action you perform in Flatfile triggers an [Event](../concepts/events). You can listen to these events to perform various tasks such as validating records and sending data to your API.

## Setting up a listener

<Note>Flatfile provides a powerful Typescript/NodeJS SDK for working with events along with many plugins. You can also listen to events
in other ways. Read the advanced docs here (TODO).</Note>

Using the `flatfile` CLI you can register any javascript function as an event listener and start working with events. To keep it simple we'll use a pre-configured Repl.it.
1. [Fork this repl.it](https://replit.com/@flatfile/get-started#index.ts)
2. Get your Secret Key from your [Developer Dashboard](https://platform.flatfile.com/developers)
3. Click Run in your Repl.it

The simplest event listener you could create looks like this. You'll see this code in the repl.it link you forked above.

```js listener.js
export default function(flatfile) {
  flatfile.on('**', (event) => {
    console.log('-> My event', event.topic)
  })
}
```

#### Subscribing to Events

After clicking the **Run** button in the pre-configured Repl.it, you will see a **Listening for Events** message in the console. To test the event listener, return to your workbook page and make a few changes to your records in the Flatfile workbook. You should see events and logs appearing in your console.

---

## Adding your first data transformation

### Using transformation & validation plugins

In this tutorial, we will transform data as it is added or modified in the sheet.

Flatfile provides a number of handy [transformation & validation plugins](https://plugins.flatfile.com) to reshape the data before it gets updated. Explore open source validation plugins available:

‚è≥**TODO make these real links**

<CardGroup cols={3}>
  <Card color="#CB3837" title="@flatfile/plugin-autocast" icon="npm" href="https://plugins.flatfile.com">
  </Card>
  <Card color="#CB3837" title="@flatfile/plugin-pretty-dates" icon="npm" href="https://plugins.flatfile.com">
  </Card>
  <Card color="#CB3837" title="@flatfile/plugin-addresses" icon="npm" href="https://plugins.flatfile.com">
  </Card>
</CardGroup>

## Using a plugin to transform data

<Tip>Plugins are helpful utilities that can be implemented with the `listener.use()` method. We explain that in depth in the [Events](../concepts/events) concepts</Tip>

For this example, we'll use <code>[@flatfile/plugin-record-hook](https://www.npmjs.com/package/@flatfile/plugin-record-hook)</code> and perform a callback function on every record that is added or modified based on the values provided inside that event.

This transformation specifically will take the first name and make it lowercase.

```ts
import { recordHook } from '@flatfile/plugin-record-hook'

export default function(listener) {
  
  listener.use(
    recordHook('contacts', (record) => {
      const value = record.get('firstName')
      record.set('firstName', value.toLowerCase())
      return record
    })
  )

}
```

## Adding your first validation

You can use any npm package inside your validation logic. In this example, we'll import the [email-validator](https://www.npmjs.com/package/email-validator) package
to make sure the email is actually valid.

<Tip>
You can use any javascript validation engine in the world to automatically detect formatting or rule-based issues
in your data.
</Tip>


```ts
import { recordHook } from '@flatfile/plugin-record-hook'
import * as EmailValidator from 'email-validator';

export default function(listener) {

  listener.use(
    recordHook('contacts', (record) => {
      const value = record.get('firstName')
      record.set('firstName', value.toLowerCase())

      if (!EmailValidator.validate(record.get('email'))) {
        record.addError('email', 'Invalid email address')
      }

      return record
    })
  )

}
```

---

## Recap & Next Steps

You now have a locally running listener that is responding to record changes in your Workbook, and can perform simple data transformations and validations.

Next, we will add an action that submits data from this Sheet to your API.
